<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="robots" content="noindex"><meta><title>分类: OS - labbeeBlog</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="labbeeBlog"><meta name="msapplication-TileImage" content="/img/favicon.svg"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="labbeeBlog"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta property="og:type" content="blog"><meta property="og:title" content="labbeeBlog"><meta property="og:url" content="http://www.labbee.top:4000/"><meta property="og:site_name" content="labbeeBlog"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="http://www.labbee.top:4000/img/og_image.png"><meta property="article:author" content="Marvin Yuan"><meta property="twitter:card" content="summary"><meta property="twitter:image:src" content="http://www.labbee.top:4000/img/og_image.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://www.labbee.top:4000"},"headline":"labbeeBlog","image":["http://www.labbee.top:4000/img/og_image.png"],"author":{"@type":"Person","name":"Marvin Yuan"},"publisher":{"@type":"Organization","name":"labbeeBlog","logo":{"@type":"ImageObject","url":"http://www.labbee.top:4000/img/logo.svg"}},"description":""}</script><link rel="icon" href="/img/favicon.svg"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.0.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/css/justifiedGallery.min.css"><!--!--><!--!--><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js"></script><!--!--><!--!--><!-- hexo injector head_end start --><script>
  (function () {
      function switchTab() {
          if (!location.hash) {
            return;
          }

          const id = '#' + CSS.escape(location.hash.substring(1));
          const $tabMenu = document.querySelector(`.tabs a[href="${id}"]`);
          if (!$tabMenu) {
            return;
          }

          const $tabMenuContainer = $tabMenu.parentElement.parentElement;
          Array.from($tabMenuContainer.children).forEach($menu => $menu.classList.remove('is-active'));
          Array.from($tabMenuContainer.querySelectorAll('a'))
              .map($menu => document.getElementById($menu.getAttribute("href").substring(1)))
              .forEach($content => $content.classList.add('is-hidden'));

          if ($tabMenu) {
              $tabMenu.parentElement.classList.add('is-active');
          }
          const $activeTab = document.querySelector(id);
          if ($activeTab) {
              $activeTab.classList.remove('is-hidden');
          }
      }
      switchTab();
      window.addEventListener('hashchange', switchTab, false);
  })();
  </script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.0.0"></head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container navbar-container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/logo.svg" alt="labbeeBlog" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">主页</a><a class="navbar-item" href="/archives">归档</a><a class="navbar-item" href="/categories">分类</a><a class="navbar-item" href="/tags">标签</a><a class="navbar-item" href="/about">关于</a></div><div class="navbar-end"><a class="navbar-item search" title="搜索" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-8-widescreen"><div class="card"><div class="card-content"><nav class="breadcrumb" aria-label="breadcrumbs"><ul><li><a href="/categories">分类</a></li><li class="is-active"><a href="#" aria-current="page">OS</a></li></ul></nav></div></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2023-11-17T07:10:00.000Z" title="11/17/2023, 3:10:00 PM">2023-11-17</time>发表</span><span class="level-item"><time dateTime="2023-11-17T07:37:33.772Z" title="11/17/2023, 3:37:33 PM">2023-11-17</time>更新</span><span class="level-item"> Marvin Yuan </span><span class="level-item"><a class="link-muted" href="/categories/OS/">OS</a><span> / </span><a class="link-muted" href="/categories/OS/ToolKits/">ToolKits</a></span><span class="level-item">2 分钟读完 (大约298个字)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2023/11/17/WSL2%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/">WSL2开发环境</a></p><div class="content"><h1 id="初始化WSL2环境"><a href="#初始化WSL2环境" class="headerlink" title="初始化WSL2环境"></a>初始化WSL2环境</h1><p>具体实现过程参考 <a href="/2023/11/14/Ubuntu%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/" title="Ubuntu基础知识">Ubuntu基础知识</a> 部分。</p>
<h1 id="安装远程桌面环境"><a href="#安装远程桌面环境" class="headerlink" title="安装远程桌面环境"></a>安装远程桌面环境</h1><p>具体实现过程参考 <a href="/2023/11/17/Linux%E5%AE%9E%E7%8E%B0%E8%BF%9C%E7%A8%8B%E6%A1%8C%E9%9D%A2%E7%8E%AF%E5%A2%83/" title="Linux实现远程桌面环境">Linux实现远程桌面环境</a>。</p>
<h1 id="配置当前用户执行sudo命令免密"><a href="#配置当前用户执行sudo命令免密" class="headerlink" title="配置当前用户执行sudo命令免密"></a>配置当前用户执行sudo命令免密</h1><blockquote>
<p>由于启动xrdp服务需要用到sudo权限，会出现输入密码的提示，较为麻烦</p>
</blockquote>
<ol>
<li>创建配置文件</li>
</ol>
  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo vim /etc/sudoers.d/[USERNAME]</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>编辑如下内容</li>
</ol>
  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[USERNAME] ALL=(ALL) NOPASSWORD: ALL</span><br></pre></td></tr></table></figure>

<h1 id="创建一键启动脚本"><a href="#创建一键启动脚本" class="headerlink" title="创建一键启动脚本"></a>创建一键启动脚本</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> ~/.local/bin -p</span><br><span class="line">vim ~/.local/bin/remote.sh</span><br></pre></td></tr></table></figure>

<p>文件末尾追加下面两行内容</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo /etc/init.d/xrdp start</span><br><span class="line">sleep 1</span><br><span class="line">mstsc.exe /v:localhost:[PORT]</span><br></pre></td></tr></table></figure>

<p>给脚本加上可执行权限</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">chmod</span> +x ~/.local/bin/remote.sh</span><br></pre></td></tr></table></figure>

<p>在windows桌面新建一个快捷方式，对象位置内容填写:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wsl ~/.local/bin/remote.sh</span><br></pre></td></tr></table></figure>

<p>双击快捷方式即可实现一键启动登录wsl2远程桌面</p>
<h1 id="CUDA-on-WSL2"><a href="#CUDA-on-WSL2" class="headerlink" title="CUDA on WSL2"></a>CUDA on WSL2</h1><p>还没有开始研究过，可参考如下文章:</p>
<ol>
<li><p><a target="_blank" rel="noopener" href="https://docs.nvidia.com/cuda/wsl-user-guide/index.html#getting-started-with-cuda-on-wsl">CUDA on WSL User Guide</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://ubuntu.com/tutorials/enabling-gpu-acceleration-on-ubuntu-on-wsl2-with-the-nvidia-cuda-platform#3-install-nvidia-cuda-on-ubuntu">Enabling GPU acceleration on Ubuntu on WSL2 with the NVIDIA CUDA Platform</a></p>
</li>
</ol>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2023-11-17T06:46:00.000Z" title="11/17/2023, 2:46:00 PM">2023-11-17</time>发表</span><span class="level-item"><time dateTime="2023-11-17T07:09:08.214Z" title="11/17/2023, 3:09:08 PM">2023-11-17</time>更新</span><span class="level-item"> Marvin Yuan </span><span class="level-item"><a class="link-muted" href="/categories/OS/">OS</a><span> / </span><a class="link-muted" href="/categories/OS/ToolKits/">ToolKits</a></span><span class="level-item">1 分钟读完 (大约123个字)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2023/11/17/Linux%E5%AE%9E%E7%8E%B0%E8%BF%9C%E7%A8%8B%E6%A1%8C%E9%9D%A2%E7%8E%AF%E5%A2%83/">Linux实现远程桌面环境</a></p><div class="content"><h1 id="环境安装"><a href="#环境安装" class="headerlink" title="环境安装"></a>环境安装</h1><ol>
<li>安装xfce4和xrdp</li>
</ol>
  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get update -y</span><br><span class="line">sudo apt-get install -y xfce4 xrdp --fix-missing</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>修改默认配置</li>
</ol>
  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">$ sudo vim /etc/xrdp/xrdp.ini</span><br><span class="line"></span><br><span class="line"><span class="comment"># 修改默认的通信端口3389，防止和windows系统的远程桌面冲突</span></span><br><span class="line">port=3390</span><br><span class="line"></span><br><span class="line"><span class="comment"># 修改Xorg配置部分以保存登录使用的账号密码，即可实现免密登录</span></span><br><span class="line">[Xorg]</span><br><span class="line">name=Xorg</span><br><span class="line">lib=libxup.so</span><br><span class="line">username=[USERNAME]</span><br><span class="line">password=[PASSWORD]</span><br><span class="line">ip=127.0.0.1</span><br><span class="line">port=-1</span><br><span class="line">code=20</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>指定session会话</li>
</ol>
  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&quot;xfce4-session&quot;</span> &gt;&gt; ~/.xsession</span><br></pre></td></tr></table></figure>

<h1 id="启用服务"><a href="#启用服务" class="headerlink" title="启用服务"></a>启用服务</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo /etc/init.d/xrdp start</span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2023-11-14T08:43:00.000Z" title="11/14/2023, 4:43:00 PM">2023-11-14</time>发表</span><span class="level-item"><time dateTime="2023-11-16T00:18:45.152Z" title="11/16/2023, 8:18:45 AM">2023-11-16</time>更新</span><span class="level-item"> Marvin Yuan </span><span class="level-item"><a class="link-muted" href="/categories/OS/">OS</a></span><span class="level-item">6 分钟读完 (大约829个字)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2023/11/14/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/">深度学习环境配置</a></p><div class="content"><h1 id="OS"><a href="#OS" class="headerlink" title="OS"></a>OS</h1><h2 id="Install-Ubuntu"><a href="#Install-Ubuntu" class="headerlink" title="Install Ubuntu"></a>Install Ubuntu</h2><p>Refer to <a href="/2023/11/14/Ubuntu%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/" title="Ubuntu基础知识">Ubuntu基础知识</a>.</p>
<h2 id="Proxy"><a href="#Proxy" class="headerlink" title="Proxy"></a>Proxy</h2><a href="/2023/11/14/%E7%BB%88%E7%AB%AF%E4%BB%A3%E7%90%86/" title="终端代理">Terminal proxy</a>

<h1 id="Setup-Nvidia-driver-cuda-cudnn-on-linux-system"><a href="#Setup-Nvidia-driver-cuda-cudnn-on-linux-system" class="headerlink" title="Setup Nvidia driver &amp; cuda &amp; cudnn on linux system"></a>Setup Nvidia driver &amp; cuda &amp; cudnn on linux system</h1><pre><code>Only valid for Debian/Ubuntu system. Other Linux distribution is continued...
N᠎OTE that the secure boot must be disable and the &quot;Driver&quot; must be disabled during the installation.
</code></pre>
<h2 id="Download"><a href="#Download" class="headerlink" title="Download"></a>Download</h2><pre><code>First we should check the right version between Nvidia driver and CUDA Toolkit via https://docs.nvidia.com/cuda/cuda-toolkit-release-notes/index.html#cuda-major-component-versions__table-cuda-toolkit-driver-versions
</code></pre>
<p><em>official url for Nvidia driver</em>:</p>
<p><a target="_blank" rel="noopener" href="https://www.nvidia.cn/Download/index.aspx?lang=cn">https://www.nvidia.cn/Download/index.aspx?lang=cn</a></p>
<p><em>official url for CUDA Toolkit</em>:</p>
<p><a target="_blank" rel="noopener" href="https://developer.nvidia.com/cuda-toolkit-archive">https://developer.nvidia.com/cuda-toolkit-archive</a></p>
<p><em>official url for cuDNN</em>:</p>
<p><a target="_blank" rel="noopener" href="https://developer.nvidia.com/rdp/cudnn-download">https://developer.nvidia.com/rdp/cudnn-download</a></p>
<h2 id="Clean"><a href="#Clean" class="headerlink" title="Clean"></a>Clean</h2><p>Start terminal and remove any NVIDIA traces you may have on your machine.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ---clean nvidia-------------</span></span><br><span class="line">sudo apt-get purge nvidia*</span><br><span class="line">sudo apt remove nvidia-* libnvidia*</span><br><span class="line"><span class="comment"># ----------------------------</span></span><br><span class="line"><span class="comment"># if you installed nvidia-docker and only want to uninstall nvidia driver, you can use the following command</span></span><br><span class="line">sudo /usr/bin/nvidia-uninstall</span><br><span class="line"><span class="comment"># ---clean cuda---------------</span></span><br><span class="line">sudo /usr/local/cuda-xx.x/bin/cuda-uninstaller</span><br><span class="line">sudo <span class="built_in">rm</span> -rf /usr/local/cuda-xx.x</span><br></pre></td></tr></table></figure>

<p>Disable the inner nouveau nvidia driver,</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># run the command to new/edit a file</span></span><br><span class="line">sudo vim /etc/modprobe.d/blacklist.conf</span><br><span class="line"></span><br><span class="line"><span class="comment"># add following lines to above file</span></span><br><span class="line">blacklist nouveau</span><br><span class="line">options nouveau modeset=0</span><br><span class="line"></span><br><span class="line"><span class="comment"># using following command to update the kernel</span></span><br><span class="line">sudo update-initramfs -u</span><br><span class="line"></span><br><span class="line"><span class="comment"># reboot and check the driver module</span></span><br><span class="line">lsmod | grep nouveau</span><br></pre></td></tr></table></figure>

<h2 id="Install"><a href="#Install" class="headerlink" title="Install"></a>Install</h2><p>Setup the correct CUDA PPA on your system</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sudo add-apt-repository ppa:graphics-drivers</span><br><span class="line">sudo apt update</span><br><span class="line">sudo service gdm3 stop <span class="comment"># or lightdm, kdm. Use &#x27;cat /etc/X11/default-display-manager&#x27; command to check which display manager is used.</span></span><br><span class="line">sudo apt-get install dkms build-essential linux-headers-generic <span class="comment"># install essential packages to build kernel module</span></span><br><span class="line">sudo apt-get install linux-headers-$(<span class="built_in">uname</span> -r)</span><br></pre></td></tr></table></figure>

<p>Install dirver, cuda and cudnn</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># First navigate to the folder where the nvidia driver is saved.</span></span><br><span class="line"><span class="comment"># install driver</span></span><br><span class="line">sudo sh NVIDIA-Linux-x86_64-470.63.01.run -no-opengl-files -no-x-check -no-nouveau-check</span><br><span class="line"></span><br><span class="line"><span class="comment"># install cuda, note that don&#x27;t select Driver</span></span><br><span class="line">sudo sh cuda_11.1.1_455.32.00_linux.run</span><br><span class="line"></span><br><span class="line"><span class="comment"># install cudnn</span></span><br><span class="line">tar -xzvf cudnn-11.2-linux-x64-v8.1.1.33.tgz</span><br><span class="line">sudo <span class="built_in">cp</span> cuda/lib64/* /usr/local/cuda-11.1/lib64/</span><br><span class="line">sudo <span class="built_in">cp</span> cuda/include/* /usr/local/cuda-11.1/include/</span><br></pre></td></tr></table></figure>

<p>As the last step one need to specify PATH to CUDA in ‘.bashrc’ file. Open the file by running:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim ~/.bashrc</span><br></pre></td></tr></table></figure>

<p>And add the following lines at the end of the file:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> CUDA_HOME=/usr/local/cuda-xx.x</span><br><span class="line"><span class="built_in">export</span> LD_LIBRARY_PATH=<span class="variable">$&#123;CUDA_HOME&#125;</span>/lib64</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$&#123;CUDA_HOME&#125;</span>/bin:<span class="variable">$&#123;PATH&#125;</span></span><br></pre></td></tr></table></figure>

<p>Restart and check the versions for the installation.</p>
<p><em>NVIDIA driver</em>:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nvidia-smi</span><br></pre></td></tr></table></figure>

<p><em>CUDA</em>:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nvcc -V</span><br></pre></td></tr></table></figure>

<p><em>cuDNN</em>:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">/sbin/ldconfig -N -v $(sed ‘s/:/ /’ &lt;&lt;&lt; <span class="variable">$LD_LIBRARY_PATH</span>) 2&gt;/dev/null | grep libcudnn</span><br><span class="line"><span class="comment"># or</span></span><br><span class="line"><span class="built_in">cat</span> /usr/local/cuda/include/cudnn_version.h | grep CUDNN_MAJOR -A 2</span><br></pre></td></tr></table></figure>

<p>Start display manager.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo service gdm3 start</span><br></pre></td></tr></table></figure>

<h1 id="Setup-remote-desktop"><a href="#Setup-remote-desktop" class="headerlink" title="Setup remote desktop"></a>Setup remote desktop</h1><p>After updates, run below command to install XRDP on your server</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install xrdp</span><br></pre></td></tr></table></figure>

<h2 id="Step-1-Install-your-preferred-desktop-environment"><a href="#Step-1-Install-your-preferred-desktop-environment" class="headerlink" title="Step 1: Install your preferred desktop environment"></a>Step 1: Install your preferred desktop environment</h2><p>To install XFCE, please use below command</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install xfce4</span><br><span class="line"><span class="comment"># optional</span></span><br><span class="line">sudo apt-get install xfce4-terminal</span><br></pre></td></tr></table></figure>

<p>After installation, configure XRDP to use XFCE environment with below command（may be unnecessary, need to test）</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo sed -i.bak <span class="string">&#x27;/fi/a #xrdp multiple users configuration \n xfce-session \n&#x27;</span> /etc/xrdp/startwm.sh</span><br></pre></td></tr></table></figure>

<p>By default Xrdp uses the &#x2F;etc&#x2F;ssl&#x2F;private&#x2F;ssl-cert-snakeoil.key file which is readable only by users that are members of the “ssl-cert” group. Execute the<br>following command to add the xrdp user to the group</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo adduser xrdp ssl-cert</span><br></pre></td></tr></table></figure>

<h2 id="Step-2-Allow-RDP-port-in-Firewall"><a href="#Step-2-Allow-RDP-port-in-Firewall" class="headerlink" title="Step 2: Allow RDP port in Firewall"></a>Step 2: Allow RDP port in Firewall</h2><p>Post configuring, To connect with the RDP session you need to allow the port in firewall which by default is closed. Run the below command to open the port in Ubuntu 18.04</p>
<p>If you have enabled UFW, Use below command</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># optional, 如果没有ufw命令请安装</span></span><br><span class="line">sudo apt-get install ufw</span><br><span class="line"><span class="comment"># ---------------------------------</span></span><br><span class="line">sudo ufw allow 3389/tcp</span><br><span class="line"><span class="comment"># 或者关闭防火墙</span></span><br><span class="line">sudo ufw <span class="built_in">disable</span></span><br></pre></td></tr></table></figure>

<p><strong>(Optional)</strong> If Iptables is running on your server, Use below command</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo iptables -A INPUT -p tcp --dport 3389 -j ACCEPT</span><br><span class="line">sudo netfilter-persistent save</span><br><span class="line">sudo netfilter-persistent reload</span><br></pre></td></tr></table></figure>

<h2 id="Step-3-Restart-the-Xrdp-application"><a href="#Step-3-Restart-the-Xrdp-application" class="headerlink" title="Step 3: Restart the Xrdp application"></a>Step 3: Restart the Xrdp application</h2><p>Restart once the Xrdp application to make sure all the above changes are reflected.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl restart xrdp</span><br></pre></td></tr></table></figure>

<p>Run the following commands only once the first time you log on the machine</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> xfce4-session &gt;~/.xsession</span><br></pre></td></tr></table></figure>

<h2 id="Step-4-Address-the-black-screen-problem"><a href="#Step-4-Address-the-black-screen-problem" class="headerlink" title="Step 4: Address the black screen problem"></a>Step 4: Address the black screen problem</h2><p>edit the <code>startwm.sh</code> file</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">$ sudo vim /etc/xrdp/startwm.sh</span><br><span class="line"></span><br><span class="line"><span class="comment"># append the following code piece before the specific position</span></span><br><span class="line"><span class="built_in">unset</span> DBUS_SESSION_BUS_ADDRESS</span><br><span class="line"><span class="built_in">unset</span> XDG_RUNTIME_DIR</span><br><span class="line">. <span class="variable">$HOME</span>/.profile</span><br><span class="line">←</span><br><span class="line"><span class="keyword">if</span> <span class="built_in">test</span> -r /etc/profile; <span class="keyword">then</span></span><br><span class="line">...</span><br><span class="line">...</span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2023-11-14T08:41:00.000Z" title="11/14/2023, 4:41:00 PM">2023-11-14</time>发表</span><span class="level-item"><time dateTime="2023-11-16T00:27:20.946Z" title="11/16/2023, 8:27:20 AM">2023-11-16</time>更新</span><span class="level-item"> Marvin Yuan </span><span class="level-item"><a class="link-muted" href="/categories/OS/">OS</a></span><span class="level-item">7 分钟读完 (大约1043个字)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2023/11/14/Ubuntu%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/">Ubuntu基础知识</a></p><div class="content"><h1 id="系统安装"><a href="#系统安装" class="headerlink" title="系统安装"></a>系统安装</h1><ol>
<li><p>Through镜像</p>
<p> 下载<a target="_blank" rel="noopener" href="https://ubuntu.com/download#download">官方镜像</a>，制作成启动盘</p>
<p> 格式化一块硬盘分区，再按下面的方式划分系统分区 (最简)</p>
<ul>
<li>swap    逻辑分区      电脑内存1-2倍（我的是16GB内存，所以设置为16GB）</li>
<li>&#x2F;           逻辑分区或主分区     Ext4日志文件系统    余下空间</li>
<li>&#x2F;home  可以考虑给用户文件夹单独一个分区</li>
</ul>
</li>
</ol>
<p>    划分好分区后，需要注意的是挂载点为“&#x2F;”的那一行，前面设备那一列显示应该是&#x2F;dev&#x2F;sdaX,X是一个阿拉伯数字，具体是几每个人不一样，表示的是你的&#x2F;分区按在硬盘的第几块位置，记住&#x2F;这个分区的sda后面是什么数字，然后在下面安装启动引导器设备：处，选择sdaX（X是一个阿拉伯数字）的那一项，也就是说，要将启动引导器安装在&#x2F;分区中。</p>
<ol start="2">
<li><p>Through虚拟机</p>
<p> <em>待补充…</em></p>
</li>
</ol>
<h2 id="ubuntu启动引导"><a href="#ubuntu启动引导" class="headerlink" title="ubuntu启动引导"></a>ubuntu启动引导</h2><ol>
<li><p>编辑grub配置文件：<code>sudo vim /etc/default/grub</code></p>
</li>
<li><p>注释掉：<code>GRUB_TIMEOUT_STYLE=hidden</code></p>
</li>
<li><p>修改grub等待时间，单位是秒：<code>GRUB_TIMEOUT=10</code></p>
</li>
<li><p>编辑：<code>GRUB_CMDLINE_LINUX_DEFAULT=”text”</code></p>
</li>
<li><p>修改默认启动项</p>
 <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">GRUB_DEFAULT = saved  # 上一次启动的选择项</span><br><span class="line">GRUB_DEFAULT= 2  # 这个是选择第三项：Windows</span><br></pre></td></tr></table></figure>
</li>
<li><p>执行<code>sudo update-grub</code>命令应用修改</p>
</li>
</ol>
<h2 id="Windows、Ubuntu双系统时差"><a href="#Windows、Ubuntu双系统时差" class="headerlink" title="Windows、Ubuntu双系统时差"></a>Windows、Ubuntu双系统时差</h2><p>终端执行命令</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">timedatectl set-local-rtc 1 --adjust-system-clock</span><br></pre></td></tr></table></figure>

<h2 id="issues"><a href="#issues" class="headerlink" title="issues"></a>issues</h2><h3 id="wifi无法连接解决方案"><a href="#wifi无法连接解决方案" class="headerlink" title="wifi无法连接解决方案"></a>wifi无法连接解决方案</h3><p>搜索不到附近的wifi热点，原因是ubuntu默认关闭了联想Y7000的wifi硬件，即硬阻塞显示无线和蓝牙状态，可查看状态：</p>
<p><code>rfkill list all</code></p>
<p>打开文件：</p>
<p><code>sudo gedit /etc/modprobe.d/blacklist.conf</code></p>
<p>最后一行加入：</p>
<p><code>blacklist ideapad_laptop</code></p>
<p>最后保存重启</p>
<h1 id="新建用户并添加sudo权限"><a href="#新建用户并添加sudo权限" class="headerlink" title="新建用户并添加sudo权限"></a>新建用户并添加sudo权限</h1><ol>
<li><p>如果没有root用户</p>
 <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo passwd root</span><br></pre></td></tr></table></figure>
</li>
<li><p>新建用户</p>
 <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 新建账号并自动建立用户目录</span></span><br><span class="line">sudo useradd -r -m -s /bin/bash username</span><br><span class="line"><span class="comment"># 为用户username添加sudo权限</span></span><br><span class="line">sudo usermod -a -G sudo username</span><br><span class="line"><span class="comment"># 去除用户username的sudo权限</span></span><br><span class="line">sudo usermod -G usergroup username</span><br></pre></td></tr></table></figure></li>
</ol>
<h1 id="时间同步"><a href="#时间同步" class="headerlink" title="时间同步"></a>时间同步</h1><ol>
<li><p>使用<code>date</code>或<code>timedatectl</code>确认当前时间</p>
</li>
<li><p>如果看到<code>System clock synchronized</code>值为<code>no</code>，则重启该服务</p>
 <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl restart systemd-timesyncd.service</span><br></pre></td></tr></table></figure>
<p> 如果仍然不起作用，请运行以下命令以启用时间同步：</p>
 <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo timedatectl set-ntp <span class="literal">true</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>如果非CST（中国标准时间），则更改时区</p>
 <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo timedatectl set-timezone Asia/Shanghai</span><br></pre></td></tr></table></figure></li>
</ol>
<h1 id="ca-certificate失效"><a href="#ca-certificate失效" class="headerlink" title="ca-certificate失效"></a>ca-certificate失效</h1><p>手动下载<a target="_blank" rel="noopener" href="http://archive.ubuntu.com/ubuntu/pool/main/c/ca-certificates/">最新的证书文件</a>重新安装</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /tmp</span><br><span class="line">wget http://archive.ubuntu.com/ubuntu/pool/main/c/ca-certificates/ca-certificates_20230311ubuntu0.20.04.1_all.deb</span><br><span class="line">sudo dpkg -i ./ca-certificates_20230311ubuntu0.20.04.1_all.deb</span><br></pre></td></tr></table></figure>

<h1 id="替换apt源"><a href="#替换apt源" class="headerlink" title="替换apt源"></a>替换apt源</h1><ol>
<li><p>使用<code>cat /etc/os-release</code>或<code>lsb_release -c</code>命令确认当前ubuntu系统代号Codename</p>
</li>
<li><p>备份软件源配置文件</p>
 <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo <span class="built_in">cp</span> /etc/apt/sources.list /etc/apt/sources.list.bak</span><br></pre></td></tr></table></figure>
</li>
<li><p>拷贝，注意替换系统代号。</p>
<p> <a target="_blank" rel="noopener" href="https://mirrors.tuna.tsinghua.edu.cn/help/ubuntu/">清华大学开源镜像站</a></p>
<p> <a target="_blank" rel="noopener" href="https://mirrors.ustc.edu.cn/help/ubuntu.html#id7">中科大开源镜像站</a></p>
 <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 默认注释了源码镜像以提高 apt update 速度，如有需要可自行取消注释</span></span><br><span class="line">deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal main restricted universe multiverse</span><br><span class="line"><span class="comment"># deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal main restricted universe multiverse</span></span><br><span class="line">deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-updates main restricted universe multiverse</span><br><span class="line"><span class="comment"># deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-updates main restricted universe multiverse</span></span><br><span class="line">deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-backports main restricted universe multiverse</span><br><span class="line"><span class="comment"># deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-backports main restricted universe multiverse</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-security main restricted universe multiverse</span></span><br><span class="line"><span class="comment"># # deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-security main restricted universe multiverse</span></span><br><span class="line"></span><br><span class="line">deb http://security.ubuntu.com/ubuntu/ focal-security main restricted universe multiverse</span><br><span class="line"><span class="comment"># deb-src http://security.ubuntu.com/ubuntu/ focal-security main restricted universe multiverse</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 预发布软件源，不建议启用</span></span><br><span class="line"><span class="comment"># deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-proposed main restricted universe multiverse</span></span><br><span class="line"><span class="comment"># # deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-proposed main restricted universe multiverse</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>更新</p>
 <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo apt update</span><br><span class="line">sudo apt upgrade -y --fix-missing</span><br><span class="line">sudo apt install -y --fix-missing</span><br></pre></td></tr></table></figure></li>
</ol>
<h1 id="字体"><a href="#字体" class="headerlink" title="字体"></a>字体</h1><ol>
<li><p><a target="_blank" rel="noopener" href="https://storage.googleapis.com/google-code-archive-downloads/v2/code.google.com/uigroupcode/YaHei.Consolas.1.12.zip">consolas</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://github.com/tonsky/FiraCode">Fira Code</a></p>
</li>
</ol>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2023-11-14T08:41:00.000Z" title="11/14/2023, 4:41:00 PM">2023-11-14</time>发表</span><span class="level-item"><time dateTime="2023-11-16T00:19:20.077Z" title="11/16/2023, 8:19:20 AM">2023-11-16</time>更新</span><span class="level-item"> Marvin Yuan </span><span class="level-item"><a class="link-muted" href="/categories/OS/">OS</a></span><span class="level-item">8 分钟读完 (大约1216个字)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2023/11/14/Ubuntu%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/">Ubuntu常用命令</a></p><div class="content"><h1 id="文件权限管理"><a href="#文件权限管理" class="headerlink" title="文件权限管理"></a>文件权限管理</h1><h2 id="修改文件所属组群—chgrp"><a href="#修改文件所属组群—chgrp" class="headerlink" title="修改文件所属组群—chgrp"></a>修改文件所属组群—chgrp</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">chgrp</span> <span class="variable">$group</span> /path/to/change/group</span><br><span class="line"><span class="built_in">chgrp</span> -R <span class="variable">$group</span> /path/to/change/group <span class="comment"># 改变同一目录下的所有文件夹</span></span><br></pre></td></tr></table></figure>

<h2 id="修改文件所有者—chown"><a href="#修改文件所有者—chown" class="headerlink" title="修改文件所有者—chown"></a>修改文件所有者—chown</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">chown</span> <span class="variable">$user</span> /path/to/change/group</span><br><span class="line"><span class="built_in">chown</span> -R <span class="variable">$user</span> /path/to/change/group <span class="comment"># 改变同一目录下的所有文件夹</span></span><br></pre></td></tr></table></figure>

<h2 id="文件权限—chmod"><a href="#文件权限—chmod" class="headerlink" title="文件权限—chmod"></a>文件权限—chmod</h2><p><a target="_blank" rel="noopener" href="https://www.runoob.com/linux/linux-comm-chmod.html">Linux chmod 命令 | 菜鸟教程</a></p>
<p>权限位共有10位：第一位是文件类型，第二到四位是所有者，第五到七位是所属组，第八到十位是其他人。</p>
<h1 id="自启动"><a href="#自启动" class="headerlink" title="自启动"></a>自启动</h1><h2 id="通过rc-local服务"><a href="#通过rc-local服务" class="headerlink" title="通过rc.local服务"></a>通过rc.local服务</h2><ol>
<li>将 &#x2F;lib&#x2F;systemd&#x2F;system&#x2F;rc-local.service 链接到 &#x2F;etc&#x2F;systemd&#x2F;system&#x2F; 目录下面来</li>
</ol>
  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">ln</span> -fs /lib/systemd/system/rc-local.service /etc/systemd/system/rc-local.service</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>修改rc-local.service文件内容</li>
</ol>
  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sudo <span class="built_in">echo</span> <span class="string">&quot;</span></span><br><span class="line"><span class="string">[Install]</span></span><br><span class="line"><span class="string">WantedBy=multi-user.target</span></span><br><span class="line"><span class="string">Alias=rc-local.service</span></span><br><span class="line"><span class="string">&quot;</span> &gt;&gt; etc/systemd/system/rc-local.service</span><br></pre></td></tr></table></figure>
<ol start="3">
<li>创建并编辑&#x2F;etc&#x2F;rc.local文件</li>
</ol>
  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo <span class="built_in">touch</span> /etc/rc.local</span><br><span class="line">sudo vim /etc/rc.local</span><br></pre></td></tr></table></figure>
<ol start="4">
<li>把想开机启动的脚本放入</li>
</ol>
  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line">[此处为脚本]</span><br></pre></td></tr></table></figure>

<h2 id="通过init-d脚本文件"><a href="#通过init-d脚本文件" class="headerlink" title="通过init.d脚本文件"></a>通过init.d脚本文件</h2><ol>
<li>编写脚本</li>
</ol>
  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim test.sh</span><br></pre></td></tr></table></figure>
<pre><code>先添加脚本内容抬头

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line"><span class="comment">### BEGIN INIT INFO</span></span><br><span class="line"><span class="comment"># Provides:     test</span></span><br><span class="line"><span class="comment"># Required-Start:  $remote_fs $syslog</span></span><br><span class="line"><span class="comment"># Required-Stop:   $remote_fs $syslog</span></span><br><span class="line"><span class="comment"># Default-Start:   2 3 4 5</span></span><br><span class="line"><span class="comment"># Default-Stop:   0 1 6</span></span><br><span class="line"><span class="comment"># Short-Description: start test</span></span><br><span class="line"><span class="comment"># Description:    start test</span></span><br><span class="line"><span class="comment">### END INIT INFO</span></span><br></pre></td></tr></table></figure>
然后开始编写脚本内容
</code></pre>
<ol start="2">
<li><p>将编写的脚本放入<code>/etc/init.d/</code></p>
 <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo <span class="built_in">mv</span> test.sh /etc/init.d/</span><br></pre></td></tr></table></figure>

<p> 给文件权限</p>
 <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">chmod</span> +750 test.sh</span><br></pre></td></tr></table></figure>

<p> 设置开机自动启动</p>
 <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo update-rc.d test.sh defaults NN</span><br></pre></td></tr></table></figure>

<p> NN为启动顺序，如果需要用到网络，则设置一个较大的数字如99.</p>
</li>
<li><p>卸载启动脚本</p>
 <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /etc/init.d</span><br><span class="line">sudo update-rc.d -f test.sh remove</span><br></pre></td></tr></table></figure></li>
</ol>
<h1 id="移除软件"><a href="#移除软件" class="headerlink" title="移除软件"></a>移除软件</h1>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get --purge remove 软件名</span><br></pre></td></tr></table></figure>

<h1 id="磁盘分区"><a href="#磁盘分区" class="headerlink" title="磁盘分区"></a>磁盘分区</h1><p>fdisk命令详解：</p>
<p>m：获取帮助</p>
<p>n：新建分区</p>
<p>p：显示分区表</p>
<p>d：删除分区</p>
<p>b：设置卷标</p>
<p>w：写入分区表</p>
<p>t：改变分区文件系统类型</p>
<p>v：检验分区</p>
<p>l：显示fdisk所支持的文件系统代码</p>
<p>q：退出</p>
<h3 id="格式化分区"><a href="#格式化分区" class="headerlink" title="格式化分区"></a>格式化分区</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mkfs -t ext4 /dev/sda1</span><br><span class="line">mkfs -t ext4 /dev/sda2</span><br></pre></td></tr></table></figure>

<h1 id="后台进程管理"><a href="#后台进程管理" class="headerlink" title="后台进程管理"></a>后台进程管理</h1><ol>
<li>&amp;<br>加在一个命令的最后，可以把这个命令放到后台执行 ,如gftp &amp;,  </li>
<li>ctrl + z<br>可以将一个正在前台执行的命令放到后台，并且处于暂停状态，不可执行  </li>
<li>jobs<br>查看当前有多少在后台运行的命令<br>jobs -l选项可显示所有任务的PID，jobs的状态可以是running, stopped, Terminated,但是如果任务被终止了（kill），shell 从当前的shell环境已知的列表中删除任务的进程标识；也就是说，jobs命令显示的是当前shell环境中所起的后台正在运行或者被挂起的任务信息；  </li>
<li>fg<br>将后台中的命令调至前台继续运行<br>如果后台中有多个命令，可以用 fg %jobnumber将选中的命令调出，%jobnumber是通过jobs命令查到的后台正在执行的命令的序号(不是pid)  </li>
<li>bg<br>将一个在后台暂停的命令，变成继续执行 （在后台执行）<br>如果后台中有多个命令，可以用bg %jobnumber将选中的命令调出，%jobnumber是通过jobs命令查到的后台正在执行的命令的序号(不是pid)<br>将任务转移到后台运行：<br>先ctrl + z；再bg，这样进程就被移到后台运行，终端还能继续接受命令。</li>
</ol>
<h2 id="ctrl-z（挂起）、ctrl-c（中断）、ctrl-（退出）和ctrl-d（EOF）的区别"><a href="#ctrl-z（挂起）、ctrl-c（中断）、ctrl-（退出）和ctrl-d（EOF）的区别" class="headerlink" title="ctrl+z（挂起）、ctrl+c（中断）、ctrl+\（退出）和ctrl+d（EOF）的区别"></a>ctrl+z（挂起）、ctrl+c（中断）、ctrl+\（退出）和ctrl+d（EOF）的区别</h2><p>ctrl+c强行中断当前程序的执行。</p>
<p>ctrl+z将任务中断,但是此任务并没有结束,他仍然在进程中，只是放到后台并维持挂起的状态。如需其在后台继续运行，需用“bg 进程号”使其继续运行；再用”fg 进程号”可将后台进程前台化。</p>
<p>ctrl+\表示退出。</p>
<p>ctrl+d表示结束当前输入（即用户不再给当前程序发出指令），那么Linux通常将结束当前程序。</p>
<h1 id="清理空间"><a href="#清理空间" class="headerlink" title="清理空间"></a>清理空间</h1><h2 id="to-Server"><a href="#to-Server" class="headerlink" title="to Server"></a>to Server</h2><p>在服务器上使用ncdu</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install ncdu</span><br><span class="line"><span class="comment"># 以清理日志文件为例</span></span><br><span class="line">sudo ncdu /var/log</span><br></pre></td></tr></table></figure>

<h2 id="to-Client"><a href="#to-Client" class="headerlink" title="to Client"></a>to Client</h2><p>在桌面版本用图形化的baobab工具。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install baobab</span><br></pre></td></tr></table></figure>

<h1 id="压缩解压"><a href="#压缩解压" class="headerlink" title="压缩解压"></a>压缩解压</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 压缩</span></span><br><span class="line">tar -zcvf xx.tar.gz &lt;target folder&gt;/</span><br><span class="line"><span class="comment"># 解压</span></span><br><span class="line">tar -zxvf xx.tar.gz &lt;destination folder&gt;</span><br></pre></td></tr></table></figure>

<h1 id="磁盘操作"><a href="#磁盘操作" class="headerlink" title="磁盘操作"></a>磁盘操作</h1><h2 id="挂载磁盘"><a href="#挂载磁盘" class="headerlink" title="挂载磁盘"></a>挂载磁盘</h2><ol>
<li><p>查看硬盘UUID</p>
 <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo blkid</span><br></pre></td></tr></table></figure>
</li>
<li><p>创建挂载点</p>
 <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo <span class="built_in">mkdir</span> /mnt/xxx</span><br></pre></td></tr></table></figure>
</li>
<li><p>挂载</p>
 <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mount /dev/xxx /mnt/xxx</span><br></pre></td></tr></table></figure>
</li>
<li><p>开机自动挂载</p>
 <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 修改/etc/fstab文件内容</span></span><br><span class="line">sudo vim /etc/fstab</span><br><span class="line"><span class="comment"># 添加到文件</span></span><br><span class="line">UUID=XXX-XXX-XXX /mnt/xx ext4 defaults 0 2</span><br><span class="line"><span class="comment"># 挂载NTFS文件系统</span></span><br><span class="line">UUID= /mnt/xxx ntfs defaults 0 2</span><br></pre></td></tr></table></figure></li>
</ol>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2023-11-14T08:39:00.000Z" title="11/14/2023, 4:39:00 PM">2023-11-14</time>发表</span><span class="level-item"><time dateTime="2023-11-16T00:18:59.552Z" title="11/16/2023, 8:18:59 AM">2023-11-16</time>更新</span><span class="level-item"> Marvin Yuan </span><span class="level-item"><a class="link-muted" href="/categories/OS/">OS</a></span><span class="level-item">2 分钟读完 (大约323个字)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2023/11/14/%E7%BB%88%E7%AB%AF%E4%BB%A3%E7%90%86/">终端代理</a></p><div class="content"><h1 id="Windows-platform"><a href="#Windows-platform" class="headerlink" title="Windows platform"></a>Windows platform</h1><h2 id="临时生效"><a href="#临时生效" class="headerlink" title="临时生效"></a>临时生效</h2><p>在windows的cmd命令行执行下面命令：</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用socks5代理</span></span><br><span class="line"><span class="built_in">set</span> http_proxy=socks5://<span class="number">127.0</span>.<span class="number">0.1</span>:端口号</span><br><span class="line"><span class="built_in">set</span> https_proxy=socks5://<span class="number">127.0</span>.<span class="number">0.1</span>:端口号</span><br><span class="line"><span class="comment"># 使用http代理</span></span><br><span class="line"><span class="built_in">set</span> http_proxy=http://<span class="number">127.0</span>.<span class="number">0.1</span>:端口号</span><br><span class="line"><span class="built_in">set</span> https_proxy=http://<span class="number">127.0</span>.<span class="number">0.1</span>:端口号</span><br></pre></td></tr></table></figure>

<p>取消设置</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">set</span> http_proxy=</span><br><span class="line"><span class="built_in">set</span> https_proxy=</span><br></pre></td></tr></table></figure>

<h2 id="长期生效"><a href="#长期生效" class="headerlink" title="长期生效"></a>长期生效</h2><p>在<code>我的电脑</code> -&gt; <code>属性</code>-&gt; <code>高级系统设置</code>-&gt; <code>高级</code>-&gt; <code>环境变量</code>，然后在 <code>系统环境</code>中，新建两个系统环境变量，变量名称分别为 <code>https_proxy</code>和<code>http_proxy</code>，值为 <code>https_proxy=socks5://127.0.0.1:端口号</code></p>
<h1 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h1><p>在cmd命令行使用<code>curl www.google.com</code>，如果有内容返回，说明设置成功（不可以用ping命令测试）。</p>
<p>如果遇到报错信息：<strong>curl : 无法分析响应内容，因为 Internet Explorer 引擎不可用，或者 Internet Explorer 的首次启动配置不完整。请指定 UseBasicParsing 参数，然后再试一次</strong>，可以参考<a target="_blank" rel="noopener" href="https://www.cnblogs.com/sjfeng1987/p/10000493.html">https://www.cnblogs.com/sjfeng1987/p/10000493.html</a></p>
<h1 id="Ubuntu"><a href="#Ubuntu" class="headerlink" title="Ubuntu"></a>Ubuntu</h1><ol>
<li><p>安装proxychains</p>
 <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install proxychains</span><br></pre></td></tr></table></figure>
</li>
<li><p>配置<strong>proxychains.conf</strong>文件</p>
 <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/proxychains.conf</span><br><span class="line"></span><br><span class="line">socks5 127.0.0.1 1080</span><br><span class="line">http 127.0.0.1 1080</span><br></pre></td></tr></table></figure>
<p> 在[ProxyList]这一行下添加<code>socks5 127.0.0.1 1080</code>，如果有别的比如<code>socks4 127.0.0.1 9050</code>那么就把它给注释掉</p>
</li>
<li><p>使用方法</p>
<p> 如使用git clone：</p>
 <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">proxychains git <span class="built_in">clone</span> https://github.com/haad/proxychains.git</span><br></pre></td></tr></table></figure></li>
</ol>
<h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><ol>
<li><a target="_blank" rel="noopener" href="https://www.cnblogs.com/hi-eric/p/11563245.html">https://www.cnblogs.com/hi-eric/p/11563245.html</a></li>
</ol>
</div></article></div></div><div class="column column-left is-4-tablet is-4-desktop is-4-widescreen  order-1"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar is-rounded" src="/images/profile.jpg" alt="Marvin Yuan"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">Marvin Yuan</p><p class="is-size-6 is-block">CV Engieer</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>SuZhou</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">文章</p><a href="/archives"><p class="title">12</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">分类</p><a href="/categories"><p class="title">4</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">标签</p><a href="/tags"><p class="title">7</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/minfengyuan" target="_blank" rel="noopener">关注我</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/minfengyuan"><i class="fab fa-github"></i></a></div></div></div><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">分类</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/DL/"><span class="level-start"><span class="level-item">DL</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/OS/"><span class="level-start"><span class="level-item">OS</span></span><span class="level-end"><span class="level-item tag">6</span></span></a><ul><li><a class="level is-mobile" href="/categories/OS/ToolKits/"><span class="level-start"><span class="level-item">ToolKits</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/ToolKits/"><span class="level-start"><span class="level-item">ToolKits</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li></ul></div></div></div><div class="card widget" data-type="archives"><div class="card-content"><div class="menu"><h3 class="menu-label">归档</h3><ul class="menu-list"><li><a class="level is-mobile" href="/archives/2023/"><span class="level-start"><span class="level-item">2023</span></span><span class="level-end"><span class="level-item tag">12</span></span></a></li></ul></div></div></div><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">标签</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/CUDA/"><span class="tag">CUDA</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Docker/"><span class="tag">Docker</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Git/"><span class="tag">Git</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Linux/"><span class="tag">Linux</span><span class="tag">7</span></a></div><div class="control"><a class="tags has-addons" href="/tags/PyTorch/"><span class="tag">PyTorch</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Python/"><span class="tag">Python</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Windows/"><span class="tag">Windows</span><span class="tag">2</span></a></div></div></div></div></div></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/logo.svg" alt="labbeeBlog" height="28"></a><p class="is-size-7"><span>&copy; 2023 Marvin Yuan</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p><p class="is-size-7">© 2019</p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("zh-cn");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="回到顶端" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "此网站使用Cookie来改善您的体验。",
          dismiss: "知道了！",
          allow: "允许使用Cookie",
          deny: "拒绝",
          link: "了解更多",
          policy: "Cookie政策",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="想要查找什么..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"想要查找什么...","untitled":"(无标题)","posts":"文章","pages":"页面","categories":"分类","tags":"标签"});
        });</script></body></html>